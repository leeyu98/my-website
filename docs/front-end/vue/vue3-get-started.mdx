---
sidebar_position: 1
displayed_sidebar: frontendSidebar
draft: true
title: Vue 3 从零开始
---

| 技术栈       | 版本     | 描述                                       |
| ------------ | -------- | ------------------------------------------ |
| Vite         | `^4.3.9` |                                            |
| Vue          | `^3.3.4` | `vue 3.3+` 中 `defineComponent` 有新的签名 |
| Element Plus | `^2.3.7` |                                            |
| Pinia        | `^2.1.4` |                                            |
| Vue Router   | `^4.2.2` |                                            |
| TypeScript   | `^5.0.2` | 使用 ts 模版创建工程，开箱支持 ts          |

## 创建项目

> 推荐使用 `pnpm`

```bash
# npm 6.x
npm create vite@latest vue-app --template vue-ts

# npm 7+, extra double-dash is needed:
npm create vite@latest vue-app -- --template vue-ts

# yarn
yarn create vite my-vue-app --template vue

# pnpm
pnpm create vite my-vue-app --template vue
```

## 开启 JSX 支持

```bash npm2yarn
npm install @vitejs/plugin-vue-jsx -D
```

## element-plus

`Element Plus` 是基于 `Vue 3`，面向设计师和开发者的组件库。

### 安装

```bash npm2yarn
npm install element-plus --save
```

### 按需引入(自动) <Highlight>推荐</Highlight>

:::warning 注意
自动按需引入的方式仅支持以 `.vue` 形式的文件，如果想要使用纯 `TS/JS(X)` 文件的方式开发(习惯 `react` 的开发方式)，还是需要手动方式 [按需引入](#按需引入手动)。
:::

> 推荐按需引入，其他方式可参考[官网指引](https://element-plus.org/zh-CN/guide/quickstart.html)。

#### 安装插件

按需引入需要安装 `unplugin-vue-components` 和 `unplugin-auto-import` 这两款插件。

```bash npm2yarn
npm install -D unplugin-vue-components unplugin-auto-import
```

#### 修改 Vite 配置

> `webpack` `rollup` `vue-cli` 等配置参考官网指引

```ts title=vite.config.ts
import { defineConfig } from 'vite';
import AutoImport from 'unplugin-auto-import/vite';
import Components from 'unplugin-vue-components/vite';
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers';

export default defineConfig({
  plugins: [
    // ...other plugins
    AutoImport({
      imports: ['vue'], // 自动引入 vue
      dts: './typings/auto-imports.d.ts',
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      dts: './typings/components.d.ts', //指定 dts 文件生成目录
      resolvers: [ElementPlusResolver()],
    }),
  ],
});
```

配置完成之后，会自动将 `vue` 相关的 `API` 生成到 `auto-imports.d.ts` 中，所以在代码中不需要再引入 `ref` `reactive` `defineComponent` 等。当组件被代码中引用时，会自动添加到 `components.d.ts` 文件中。

```ts title=components.d.ts
// generated by unplugin-vue-components
// We suggest you to commit this file into source control
// Read more: https://github.com/vuejs/vue-next/pull/3399

declare module 'vue' {
  export interface GlobalComponents {
    ElButton: typeof import('element-plus/es')['ElButton'];
  }
}

export {};
```

:::warning 注意
为了保证 TS 的正确检验，需要将 `auto-imports.d.ts` 和 `components.d.ts` 包含到 `tsconfig.json` 的 `include` 配置项中
:::

```json title=tsconfig.json
{
  "include": ["typings/*.ts"]
}
```

#### 应用

不需要再做其他任何操作，直接在代码中直接使用组件了。

```html title=App.vue
<template>
  <el-button>hello world</el-button>
</template>
```

### 按需引入(手动)

新建文件 `element-plus.config.ts` 统一管理 `element-plus` 配置

```ts title=src/config/element-plus.config.ts
import { ElButton } from 'element-plus';

export const ElComponents = [ElButton];
```

在 `main.ts` 中引入并挂载

```ts title=main.ts
import { createApp } from 'vue';
import 'element-plus/dist/index.css';
import { ElComponents } from './config/element-plus.config';
import App from './App';

const vueApp = createApp(App);
ElComponents.forEach((el) => vueApp.component(el.name, el)); // mount element components

vueApp.mount('#app');
```

在应用时不需要引入

```tsx title=src/pages/home/index.tsx
import { defineComponent } from 'vue';

const Home = defineComponent(() => {
  return () => (
    <span>
      <el-button>Home</el-button>
    </span>
  );
}, {});

export default Home;
```

### 常见问题

> 模块 ”"element-plus"” 没有导出的成员 "ElButton"。你是想改用“import ElButton from "element-plus"”吗。

**原因**

`typescript5.0` 版本升级，使用 `compilerOptions.moduleResolution: "bundler"` 的模块编译选项。

**解决方式**

降低 `ts` 版本或者在 `tsconfig.json` 中修改 `moduleResolution`

```json title=tsconfig.json
{
  "compilerOptions": {
    "moduleResolution": "node"
  }
}
```

## ant-design-vue

`Ant Design for Vue` 也基于 `Vue 3` 进行了重构。

### 安装

```bash npm2yarn
npm install ant-design-vue --save
```

### 引入

推荐使用按需引入，配置参考[Element Plus](#引入)

### 应用

新建文件 `antd.config.ts` 统一管理 `ant-design-vue` 配置

```ts title=src/config/antd.config.ts
import { Button } from 'ant-design-vue';

export const AntComponents = [Button];
```

在 `main.ts` 中引入并挂载

```ts title=main.ts
import { createApp } from 'vue';
import 'ant-design-vue/dist/antd.css';
import { AntComponents } from './config/antd.config';
import App from './App';

const vueApp = createApp(App);
AntComponents.forEach((el) => vueApp.component(el.name, el)); // mount antd components

vueApp.mount('#app');
```

在组件中引用。有了 `unplugin-auto-import` 插件，在应用时不需要引入，直接使用就可以了。

```tsx title=src/pages/home/index.tsx
import { defineComponent } from 'vue';

const Home = defineComponent(() => {
  return () => (
    <span>
      <a-button>Home</a-button>
    </span>
  );
}, {});

export default Home;
```

## vue-router

### 安装

```bash npm2yarn
npm install vue-router@4
```

### 应用

新建 `router/index.ts` 管理路由

```ts title=src/router/index.ts
import { createRouter, createWebHistory } from 'vue-router';
import type { RouteRecordRaw } from 'vue-router';

const routes: Array<RouteRecordRaw> = [
  {
    path: '/',
    name: 'Home',
    alias: ['/home'],
    component: () => import('../pages/home'),
  },
];

export default createRouter({
  routes,
  history: createWebHistory(),
});
```

在 `main.ts` 中挂载到 vue app 实例

```ts title=main.ts
import { createApp } from 'vue';
import router from './router';
import App from './App';

const vueApp = createApp(App);

vueApp.use(router); // vue-router
vueApp.mount('#app');
```

### 常见问题

1. 日期组件中英混杂显示

需要手动设置 `dayjs` 的国际化语言，`3.x` 版本默认是 `dayjs` 如果是 `moment` 同理需要设置。

<Tabs>
<TabItem value="method-1" label="写法一" default>

```ts title=main.ts
import 'dayjs/locale/zh-cn';
```

</TabItem>
<TabItem value="method-2" label="写法二">

```ts title=main.ts
import dayjs from 'dayjs';
import zhCN from 'dayjs/locale/zh-cn';
dayjs.locale(zhCN);
```

</TabItem>
</Tabs>
